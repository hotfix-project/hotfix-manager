webpackJsonp([4,3],{34:function(t,s,a){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(s,"__esModule",{value:!0});var e=a(1),c=(i(e),a(5)),l=i(c),o=a(3),n=i(o),d=a(4);a(140);s.default={name:"v-details",created:function(){this.getPatchDetail(),this.getVersionName()},data:function(){return{patchList:"",versionName:"",tipFlag:!1,apply_count:1,checkFlag1:!0,checkFlag2:!1,dialogFlag:!1,versionId:"",patchId:"",downLoad:"",pool_size:1}},watch:{},computed:{},methods:{back:function(){this.$router.go(-1)},cancel:function(){this.dialogFlag=!1,this.$overlay({show:!1})},getPatchDetail:function(){this.patchId=(0,d.queryString)("patchId"),this.versionId=(0,d.queryString)("version"),self=this,self.$http({url:n.default.patchs+"/"+this.patchId,method:"get"}).then(function(t){200==t.status&&(self.patchList=t.body,self.downLoad=self.patchList.download_url)})},getVersionName:function(){var t=this;t.$http({url:n.default.versions+"/"+this.versionId,method:"get"}).then(function(s){200==s.status&&(t.versionName=s.body.name)})},sotpIssuing:function(){this.$overlay(),this.dialogFlag=!0},sureSotp:function(){var t=this;this.$http({url:n.default.patchs+"/"+this.patchId,method:"put",body:{version_id:n.default.versions+"/"+this.versionId,size:this.patchList.size,desc:this.patchList.desc,download_url:this.patchList.download_url,serial_number:this.patchList.serial_number,status:4}}).then(function(s){200==s.status&&(t.patchList=s.body,t.$toast("停止发布成功",{duration:2e3}),t.cancel())})},issuing:function(){var t=this;this.checkFlag1?this.$http({url:n.default.patchs+"/"+this.patchId,method:"put",body:{version_id:n.default.versions+"/"+this.versionId,size:this.patchList.size,desc:this.patchList.desc,download_url:this.patchList.download_url,serial_number:this.patchList.serial_number,status:2}}).then(function(s){200==s.status&&(t.patchList=s.body,t.$toast("发布成功",{duration:2e3}),t.isIssuing=!0)}):this.$http({url:n.default.patchs+"/"+this.patchId,method:"put",body:{version_id:n.default.versions+"/"+this.versionId,size:this.patchList.size,desc:this.patchList.desc,download_url:this.patchList.download_url,serial_number:this.patchList.serial_number,status:3,pool_size:this.pool_size}}).then(function(s){t.patchList=s.body,200==s.status&&t.$toast("发布成功",{duration:2e3})})},radioCheck1:function(){this.checkFlag1||(this.checkFlag1=!0,this.checkFlag2=!1)},radioCheck2:function(){this.checkFlag2||(this.checkFlag2=!0,this.checkFlag1=!1)},reduceSize:function(){Number(this.pool_size)-100<=0?this.pool_size=1:this.pool_size=Number(this.pool_size)-100},addSize:function(){this.pool_size=Number(this.pool_size)+100}},components:{"c-footer":l.default},filters:{}}},69:function(t,s,a){var i,e;a(!function(){var t=new Error('Cannot find module "!!../../../../../node_modules/extract-text-webpack-plugin/loader.js?{"remove":true}!css!vue-loader/lib/style-rewriter?id=data-v-18509fc4&scoped=true!postcss!sass!vue-loader/lib/selector?type=styles&index=0!./patchDetail.vue"');throw t.code="MODULE_NOT_FOUND",t}()),i=a(34);var c=a(136);e=i=i||{},"object"!=typeof i.default&&"function"!=typeof i.default||(e=i=i.default),"function"==typeof e&&(e=e.options),e.render=c.render,e.staticRenderFns=c.staticRenderFns,e._scopeId="data-v-18509fc4",t.exports=i},136:function(t,s){t.exports={render:function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",[a("div",[a("div",{staticClass:"f22 pl20"},[a("span",{staticClass:"cursor",on:{click:t.back}},[t._v("<")]),t._v("\n           补丁详情\n         ")]),t._v(" "),a("div",{staticClass:"p20"},[a("div",{staticClass:"boxLeft l mr20 bg-white bde"},[a("ul",{staticClass:"p20 f12 g6"},[a("li",{staticClass:"f14"},[t._v("补丁属性")]),t._v(" "),a("li",[a("span",[t._v("补丁版本：")]),t._v(" "),a("span",[t._v(t._s(t.patchList.serial_number))])]),t._v(" "),a("li",[a("span",[t._v("应用版本：")]),t._v(" "),a("span",[t._v(t._s(t.versionName))])]),t._v(" "),a("li",[a("span",[t._v("补丁描述：")]),t._v(" "),a("span",{staticClass:"describe"},[t._v(t._s(t.patchList.desc))])]),t._v(" "),a("li",[a("span",[t._v("文件大小：")]),t._v(" "),a("span",[t._v(t._s(t.patchList.size+"KB"))])]),t._v(" "),a("li",[a("span",[t._v("补丁文件：")]),t._v(" "),a("a",{staticClass:"blue",attrs:{href:t.patchList.download_url,target:"_blank"}},[t._v("下载")])])])]),t._v(" "),a("div",{staticClass:"boxRight bg-white p20 f14 bde tc"},[a("div",{staticClass:"tl"},[t._v("补丁发布")]),t._v(" "),a("div",{staticClass:"bbe cl h100 pb20 pt20"},[a("qriously",{staticClass:"ewm l mr20",attrs:{value:t.downLoad,size:90}}),t._v(" "),t._m(0)],1),t._v(" "),2==t.patchList.status||3==t.patchList.status?a("div",{staticClass:"flex"},[a("div",{staticClass:"flexBox bd4 l mr55"},[a("div",{staticClass:"f30"},[t._v(t._s(t.patchList.download_count))]),t._v(" "),a("div",[t._v("累计加载设备数")])]),t._v(" "),a("div",{staticClass:"flexBox bd4 l"},[a("div",{staticClass:"f30"},[t._v(t._s(t.patchList.apply_count))]),t._v(" "),a("div",[t._v("成功推送设备数")])])]):a("div",{staticClass:"flex"},[a("div",{staticClass:"flexBox l mr55 fbB rel f12 g9"},[a("div",{staticClass:"radio abs",class:t.checkFlag1?"checked":"",on:{click:t.radioCheck1}}),t._v(" "),a("div",{staticClass:"f16 pb10"},[t._v("全量发布")]),t._v(" "),a("div",[t._v("对全量用户推送该补丁")])]),t._v(" "),a("div",{staticClass:"flexBox fbB l  rel f12 g9 rel"},[a("div",{staticClass:"radio abs",class:t.checkFlag2?"checked":"",on:{click:t.radioCheck2}}),t._v(" "),a("div",{staticClass:"f16 pb10"},[t._v("灰度发布")]),t._v(" "),a("div",[t._v("对部分用户推送该补丁")]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.checkFlag2,expression:"checkFlag2"}],staticClass:"pt10 cl"},[a("span",{staticClass:"l tipW",on:{mouseover:function(s){t.tipFlag=!0},mouseout:function(s){t.tipFlag=!1}}}),t._v(" "),a("span",{staticClass:"l"},[t._v("设备数: ")]),t._v(" "),a("span",{staticClass:"boxA bde l ml5 reduce",on:{click:t.reduceSize}},[t._v("-")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pool_size,expression:"pool_size"}],staticClass:"centerBox bde l",attrs:{type:"text",autofocus:"autofocus"},domProps:{value:t.pool_size},on:{input:function(s){s.target.composing||(t.pool_size=s.target.value)}}}),t._v(" "),a("span",{staticClass:"add boxA bde l",on:{click:t.addSize}},[t._v("+")])]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.tipFlag,expression:"tipFlag"}],staticClass:"abs tip"},[t._v("设备数是指设备请求更新patch的次数")])])]),t._v(" "),1==t.patchList.status||4==t.patchList.status?a("span",{staticClass:"minBtn mt40",class:1==t.patchList.status?"bg":"",on:{click:t.issuing}},[t._v(t._s(1==t.patchList.status?"确认发布":"继续发布"))]):a("span",{staticClass:"minBtn mt40",on:{click:t.sotpIssuing}},[t._v("停止发布")]),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:4==t.patchList.status,expression:"patchList.status==4"}],staticClass:"minBtn mt40 ml20",on:{click:t.back}},[t._v("选择回滚")])])])]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.dialogFlag,expression:"dialogFlag"}],staticClass:"modal"},[t._m(1),t._v(" "),a("div",{staticClass:"modal-buttons",attrs:{"data-v-aebaf62a":""}},[a("span",{staticClass:"modal-button cursor",attrs:{"data-v-aebaf62a":""},on:{click:t.sureSotp}},[t._v("确定")]),t._v(" "),a("span",{staticClass:"modal-button modal-button-cancel cursor",attrs:{"data-v-aebaf62a":""},on:{click:t.cancel}},[t._v("取消")])])])])},staticRenderFns:[function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"l tl"},[a("p",{staticClass:"pt20 pb10"},[t._v("正式发布前建议您先进行本地测试")]),t._v(" "),a("p",[t._v("请使用hotfixdebug扫描左侧二维码，下载补丁进行本地调试")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"modal-inner"},[a("div",{staticClass:"modal-title"},[a("div",{attrs:{"data-v-aebaf62a":""}},[t._v("操作提示")])]),t._v(" "),a("div",{staticClass:"modal-text f12 mt20 mb20"},[a("div",{staticClass:"tl flexBox warn"},[a("b",{staticClass:"f14"},[t._v("确定要停止发布吗？")]),t._v(" "),a("p",{staticClass:"f12"},[t._v("停止发布后将使未收到推送的设备不再更新补丁。")]),t._v(" "),a("p",{staticClass:"f12"},[t._v("停止发布后仍可恢复发布")])])])])}]}}});
//# sourceMappingURL=patchDetail.ba9ae4d9.js.map